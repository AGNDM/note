## Simplex method
### 规范型

1. 目标函数和基变量无关
2. 基矩阵是单位矩阵

#### 如何获取？
| Base   | $c^T$ | $balance = 0$ |
| --- | ------- | ------ |
| |$A^T$|$b$

Turn $A^T = (A_{B}\; A_{N})$ into 

$$
\begin{pmatrix}
 I\;A'
\end{pmatrix}
= A_{B}^{-1}A
$$

Note that $A_B^{-1}$ is $m\times m$ and $A$ is $m\times n$.


| Base   | $c^T$ | $balance = 0$ |
| --- | ------- | ------ |
| |$A_{规范型}=A_{B}^{-1}A^T$|$A_{B}^{-1}b$

| Base   | $c_{{规范型}}=c^T - c_{B}^TA_{规范型}$ | $balance = -c_{B}^TA_{规范型}$ |
| --- | ------- | ------ |
| |$A_{规范型}=A_{B}^{-1}A^T$|$A_{B}^{-1}b$

### 检验最优
如果$c_{规范型}$中全都是正的，那么就已经最优了，因为没有减小的空间了

### 变换基
$\exists c_{i}<0$，需要变换基

我们假设需要用$x_i$把$x_j$换掉，那么我们考虑$x_j$的一些性质：
	1. $x_j=b_{k}$， $k$是$x_j$作为基的那一行
	2. 除了第$k$行，其他行都没有$x_j$的出现，这是由规范型所保证的
	3. 我们单独考察第$k$行，也就是第$k$个等式：
		1. 这个等式中，$x_j$是唯一一个系数不为0且本身不为0的数
		2. $x_i$的系数非零

所以我们可以发现，要使第$k$行继续成立，我们必须要保证

$$
	A_{ki}x_{i}+A_{kj}x_{j}=b_{k}
$$

很简单地，我们考虑只有一个约束和两个变量的例子：

$$
	ax_{1}+bx_{2}=c
$$

$$
\begin{align*}
	x_{1},x_{2} \ge 0\\
\end{align*}
$$

首先在规范型中$b=1$，因此我们可以在这里假设$b>0$

其次，由于在变换前，$x_{2} = \frac{c}{b} \ge 0$所以我们有$c \ge 0$，

我们要用$x_{1}$替换$x_{2}$

如果$a>0$，那么

$$
\begin{align*}
\max x_{1}=\frac{1}{a}(c-bx_{2})&=\frac{c}{a}\\
	x_{2}&=0\text{ 时取到}
\end{align*}
$$

如果$a<0$，那么

$$
\begin{align*}
\max x_{1}=\frac{1}{-a}(bx_{2}-c)&= \infty\text{ 无界}\\
x_{2}&=\infty\text{ 时取到}
\end{align*}
$$

回到原本的问题，将$A_{kj} = 1$(规范型)带入，

$$
	x_{i} = \frac{b_{k}-x_{j}}{A_{ki}}
$$

$x_{j}$是我们唯一可以改变的，我们希望把它变化到0来让$x_i$取到最大，从而使目标函数最小
在变换前，我们有

$$
	x_{j} = b_{k} > 0
$$

那么有两种取法,
- 一种是当$A_{ki}>0$，我们让$x_j=0$取到最大值$\frac{b_{k}}{A_{ki}}$，也就是我们可以在$x_i$上走的最大步长
- 另一种是当$A_{ki}<0$，我们让$x_j=\infty$从而使目标函数无界

这两种情况与之前的例子一一对应

我们的最小比值法就是将第一种情况对每一个等式进行检查，取出最保守的那一种可能

奇妙的是，由于单纯型表并不会记录$x$的取值，所以其实我们的换基操作中对$x_i,x_j$的改变本质上并不会在单纯型表中有所记录，我们只是在做LP问题的等价变形。

当我们把新的基变量的系数变为1时，自然而然地就会有在第$k$行，$x_{i}=b_{k}$

## 最终的函数值

为什么最终的函数值就是表中的$-balance$
我们用约束中的行将目标函数行进行高斯消元本质上是用确定性去替代不确定性。其逻辑是：

$$
\min c^Tx \rightarrow \min c^Tx-b_{k} \rightarrow \min c^Tx-A_{k}^Tx \quad where\;A_{k}^Tx=b_{k}
$$

其确定性的部分$b_k$自然而然地被我们以相反数的形式记录在了$balance$里，而表中的目标函数块（不确定的部分）被我们维护着始终取最小值也就是0（通过对$x$的赋值），直到我们发现没有可以优化的可能了（目标函数中洗漱吧全是正的）。此时不确定的部分为0，确定的部分为$-balance$，相加即为最小值

### 检验数

$$
	c^T-(某些高斯消元)
$$

也就是单纯型表的第一行第二列中的诸多值
检验数可以表示当前的非基变量对函数值的影响

|±\abs  | 大 | 小 |
| -- | -- | -- |
|正|变大很多|变大较小
|负|变小很多|变小较小

检验数可以指导我们加入新基替换旧的

